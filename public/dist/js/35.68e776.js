(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{67:function(e,t,s){"use strict";s.r(t);var r=s(0),i=s.n(r),a=s(4),n=s(2),o=s.n(n),l=s(3),c=s.n(l);function p(e,t,s,r,i,a,n){try{var o=e[a](n),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(r,i)}function u(e){return function(){var t=this,s=arguments;return new Promise((function(r,i){var a=e.apply(t,s);function n(e){p(a,r,i,n,o,"next",e)}function o(e){p(a,r,i,n,o,"throw",e)}n(void 0)}))}}function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function m(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var b={name:"ViewPermissions",middleware:["auth","permission:manage-role-permissions"],data:function(){return{permissionsTableFields:[{key:"display_name",label:"Display Name",sortable:!0},{key:"name",label:"Name",sortable:!0},{key:"description",label:"Description",sortable:!0},{key:"attach-role",label:"Attach Role"}],filter:"",pageOptions:[5,10,15],delete_id:0,timeout:0}},created:function(){var e=this.$route.params.id;this.$store.dispatch("management/fetchRole",{role_id:e}),this.$store.dispatch("management/fetchPermissions",{search:this.filter})},computed:m({},Object(a.c)({role:function(e){return e.management.role},permissions:function(e){return e.management.permissions}})),methods:{remove:function(){var e=this;return u(i.a.mark((function t(){var s,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.a.delete("/api/permissions/"+e.delete_id);case 3:s=t.sent,r=s.data,e.$store.dispatch("management/fetchPermissions",{search:e.filter}),e.$alert(r.message,r.status),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),e.$error("some error occurred");case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},filterData:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e.$store.dispatch("management/fetchPermissions",{search:e.filter})}),100)},syncPermission:function(e){var t=this;return u(i.a.mark((function s(){var r,a,n,o;return i.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(r=t.role.permissions.findIndex((function(t){return t.id==e.id})))<0?t.role.permissions.push(e):t.role.permissions.splice(r,1),s.prev=2,a=new c.a(m({},t.role)),s.next=6,a.put("/api/roles/"+t.role.id);case 6:n=s.sent,o=n.data,t.$alert(o.message,o.status),s.next=15;break;case 11:s.prev=11,s.t0=s.catch(2),console.log(s.t0),t.$error("some error occured");case 15:case"end":return s.stop()}}),s,null,[[2,11]])})))()}},watch:{filter:{handler:function(){this.filterData()}},"permissions.page":{handler:function(){this.filterData()}}}},h=s(1),v=Object(h.a)(b,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Breadcrumbs",{attrs:{title:e.role&&e.role.display_name+" Permissions",main:"Roles"}}),e._v(" "),s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header d-flex justify-content-between"},[s("div",{staticClass:"card-title"},[s("h5",[e._v("Role Permissions")]),s("span",[e._v("Set permissions for the role "+e._s(e.role&&e.role.display_name))])])]),e._v(" "),s("div",{staticClass:"card-body"},[s("b-row",[s("b-col",{attrs:{md:"6"}},[s("b-input-group",{staticClass:"datatable-btn"},[s("b-form-input",{attrs:{placeholder:"Type to Search"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),e._v(" "),s("b-input-group-append",[s("b-button",{attrs:{disabled:!e.filter},on:{click:function(t){e.filter=""}}},[e._v("Clear")])],1)],1)],1),e._v(" "),s("b-col",{attrs:{md:"6"}},[s("b-form-group",{staticClass:"mb-0 datatable-select",attrs:{"label-cols":"2",label:"Per page"}},[s("b-form-select",{attrs:{options:e.pageOptions},model:{value:e.permissions.perPage,callback:function(t){e.$set(e.permissions,"perPage",t)},expression:"permissions.perPage"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"table-responsive datatable-vue"},[s("b-table",{attrs:{"show-empty":"",stacked:"md",items:e.permissions.data,fields:e.permissionsTableFields},scopedSlots:e._u([{key:"cell(attach-role)",fn:function(t){return[s("div",{staticClass:"media"},[s("div",{staticClass:"media-body text-center"},[s("label",{staticClass:"switch mb-0"},[s("input",{attrs:{type:"checkbox"},domProps:{checked:e.role&&e.role.permissions.findIndex((function(e){return t.item.id==e.id}))>-1},on:{input:function(s){return e.syncPermission(t.item)}}}),s("span",{staticClass:"switch-state shadow-showcase shadow-sm border"})])])])]}}])})],1),e._v(" "),s("b-col",{staticClass:"my-1",attrs:{md:"6"}},[s("b-pagination",{staticClass:"my-0",attrs:{"total-rows":e.permissions.count,"per-page":e.permissions.perPage},model:{value:e.permissions.page,callback:function(t){e.$set(e.permissions,"page",t)},expression:"permissions.page"}})],1)],1)])])])]),e._v(" "),s("b-modal",{staticClass:"theme-modal",attrs:{id:"modal-delete-permission",size:"sm",centered:"",title:"Delete Role","ok-title":"Delete","ok-variant":"danger"},on:{ok:e.remove}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("p",[e._v("Are you sure you want to delete this permission?")])])])])],1)}),[],!1,null,null,null);t.default=v.exports}}]);