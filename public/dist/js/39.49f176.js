(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{72:function(e,r,s){"use strict";s.r(r);var t=s(0),a=s.n(t),o=s(3),n=s.n(o),i=(s(2),s(4));function l(e,r,s,t,a,o,n){try{var i=e[o](n),l=i.value}catch(e){return void s(e)}i.done?r(l):Promise.resolve(l).then(t,a)}function c(e){return function(){var r=this,s=arguments;return new Promise((function(t,a){var o=e.apply(r,s);function n(e){l(o,t,a,n,i,"next",e)}function i(e){l(o,t,a,n,i,"throw",e)}n(void 0)}))}}function d(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function m(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?d(Object(s),!0).forEach((function(r){u(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}function u(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}var f={name:"CreateUser",middleware:["auth","permission:update-user"],data:function(){return{form:new n.a({role_id:"",name:"",emai:""}),changePassword:new n.a({password:"",password_confirmation:""})}},created:function(){this.$store.dispatch("management/fetchAllRoles",{search:this.filter});var e=this.$route.params.id;this.$store.dispatch("management/fetchUser",{user_id:e})},computed:m(m({},Object(i.c)({user:function(e){return e.management.user},roles:function(e){return e.management.all_roles}})),{},{getRoles:function(){return this.roles.filter((function(e){return"employer"!=e.name}))}}),methods:{updateUser:function(){var e=this;return c(a.a.mark((function r(){var s,t;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.form.put("/api/users/"+e.user.id);case 3:s=r.sent,t=s.data,e.$alert(t.message,t.status),e.$router.push("/users"),e.form.reset(),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.log(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},updatePassword:function(e){var r=this;return c(a.a.mark((function s(){var t,o;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e.preventDefault(),s.prev=1,s.next=4,r.changePassword.put("/api/users/"+r.user.id+"/password");case 4:t=s.sent,o=t.data,r.$alert(o.message,o.status),r.$bvModal.hide("modal-change-user-password"),r.changePassword.reset(),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),console.log(s.t0);case 14:case"end":return s.stop()}}),s,null,[[1,11]])})))()}},watch:{user:{handler:function(){this.form.role_id=this.user.roles[0].id,this.form.name=this.user.name,this.form.email=this.user.email}}}},v=s(1),p=Object(v.a)(f,(function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",[s("Breadcrumbs",{attrs:{title:"Edit User",main:"Users"}}),e._v(" "),s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"card"},[e._m(0),e._v(" "),s("div",{staticClass:"card-body"},[s("b-form",{staticClass:"needs-validation",on:{submit:function(r){return r.preventDefault(),e.updateUser(r)}}},[s("div",{staticClass:"form-row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-form-label col-sm-3"},[e._v("Select Role:")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.form.role_id,expression:"form.role_id"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("role_id")},on:{change:function(r){var s=Array.prototype.filter.call(r.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.form,"role_id",r.target.multiple?s:s[0])}}},[s("option",{attrs:{value:""}},[e._v("Select Role")]),e._v(" "),e._l(e.getRoles,(function(r,t){return s("option",{key:t,domProps:{value:r.id}},[e._v(e._s(r.display_name))])}))],2),e._v(" "),s("has-error",{attrs:{form:e.form,field:"role_id"}})],1)]),e._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-form-label col-sm-3"},[e._v("Name:")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("name")},attrs:{type:"text"},domProps:{value:e.form.name},on:{input:function(r){r.target.composing||e.$set(e.form,"name",r.target.value)}}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"name"}})],1)]),e._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-form-label col-sm-3"},[e._v("Email:")]),e._v(" "),s("div",{staticClass:"col-sm-9"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":e.form.errors.has("email")},attrs:{type:"email"},domProps:{value:e.form.email},on:{input:function(r){r.target.composing||e.$set(e.form,"email",r.target.value)}}}),e._v(" "),s("has-error",{attrs:{form:e.form,field:"email"}})],1)])]),e._v(" "),s("div",{staticClass:"col-12 text-right"},[s("button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-change-user-password",modifiers:{"modal-change-user-password":!0}}],staticClass:"btn btn-outline-primary",attrs:{type:"button"}},[e._v("Change Password")]),e._v(" "),s("v-button",{attrs:{loading:e.form.busy}},[e._v("Update User")])],1)])])],1)])])])]),e._v(" "),s("b-modal",{staticClass:"theme-modal",attrs:{id:"modal-change-user-password",centered:"",title:"Change password","ok-title":"Change Password","ok-variant":"primary"},on:{ok:e.updatePassword}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-form-label"},[e._v("Password")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.changePassword.password,expression:"changePassword.password"}],staticClass:"form-control",class:{"is-invalid":e.changePassword.errors.has("password")},attrs:{type:"password"},domProps:{value:e.changePassword.password},on:{input:function(r){r.target.composing||e.$set(e.changePassword,"password",r.target.value)}}}),e._v(" "),s("has-error",{attrs:{form:e.changePassword,field:"password"}})],1),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-form-label"},[e._v("Confirm Password")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.changePassword.password_confirmation,expression:"changePassword.password_confirmation"}],staticClass:"form-control",class:{"is-invalid":e.changePassword.errors.has("password_confirmation")},attrs:{type:"password"},domProps:{value:e.changePassword.password_confirmation},on:{input:function(r){r.target.composing||e.$set(e.changePassword,"password_confirmation",r.target.value)}}}),e._v(" "),s("has-error",{attrs:{form:e.changePassword,field:"password_confirmation"}})],1)])])])],1)}),[function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"card-header"},[r("h5",[this._v("Edit User")]),r("span",[this._v("Edit this user")])])}],!1,null,null,null);r.default=p.exports}}]);